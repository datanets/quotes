<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>Quotes</title>
  <link type="text/css" rel="stylesheet" href="css/style.css" />
</head>
<body>
  <div id="container">Loading quote...</div>

  <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js" type="text/javascript"></script>
  <script src="http://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.3.3/underscore-min.js" type="text/javascript"></script>
  <script src="http://cdnjs.cloudflare.com/ajax/libs/backbone.js/0.9.2/backbone-min.js" type="text/javascript"></script>
  
  <script type="text/javascript">
    // from example:
    // https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Math/random
    function getRandomInt(min, max) {
      return Math.floor(Math.random() * (max - min + 1)) + min;
    }

    var Quote = Backbone.Model.extend({
      body:'quote body here'
    });

    var QuoteCollection = Backbone.Collection.extend({
      model: Quote,
      url: 'data/quotes.json',
      parse: function(response){
        return response;
      }
    });
    
    var AppView = Backbone.View.extend({
      initialize: function(){
        this.quotes = new QuoteCollection();
        this.quotes.fetch();
        this.quotes.bind('reset', this.render, this);
        $('body').bind('keydown', this.logKey);
      },

      getQuote: function(){
        try {
          // get random quote
          var randomIndex = getRandomInt(0,this.quotes.length-1);
          var quoteText = this.quotes.at(randomIndex).get("body");
          quoteText = quoteText.replace(/(?:\r\n|\r|\n)/g, '<br>');
          $('#container').html(quoteText);
        }
        catch (e) {}
      },

      logKey: function(e){
        if ((e.keyCode == 39) || (e.keyCode == 37)) {
          // get new quote
          appView.getQuote();
        }
      },
      
      render: function(){
        this.getQuote();
      }
    });

    // initialize view
    var appView = new AppView();
  </script>
  
</body>
</html>
